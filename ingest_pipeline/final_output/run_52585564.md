(venv) jasonyang@Jasons-MacBook-Pro-3 ingest_pipeline % python3 ingest_pipeline.py 30s_clip.mp4
[Pipeline] Processing video: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/data/30s_clip.mp4
[Info] Intermediate outputs will be saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564

=== Step 1: Extracting audio ===
[OK] Audio extracted and saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/audio/extracted_audio.wav
[OK] Audio uploaded: media://audio/ecf22270a23e469bb04b55980cdbac0e.wav

=== Step 2: Speaker diarization ===
[OK] Found 12 speaker turns
  [001] SPEAKER_00 1.19-1.58s: Marie.
  [002] SPEAKER_00 2.23-3.21s: This is Ms. Novak.
  [003] SPEAKER_00 3.90-5.04s: She's from Chicago.
  [004] SPEAKER_00 5.49-6.80s: Marie is our receptionist.
  [005] SPEAKER_01 7.04-9.43s: It's nice to meet you. It's nice to meet you too.
  [006] SPEAKER_00 9.48-10.51s: I'll get your tickets.
  [007] SPEAKER_01 17.46-19.66s: You look very familiar to me, Marie.
  [008] SPEAKER_01 20.11-21.14s: Have we met before?
  [009] SPEAKER_00 21.57-22.68s: I don't think so.
  [010] SPEAKER_01 22.68-23.29s: No.
  [011] SPEAKER_01 24.12-26.07s: Well, I never forget a face.
  [012] SPEAKER_01 27.05-29.32s: I'm sure I know you from somewhere.
[OK] Diarization results saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/diarization.json

=== Step 3: Extracting faces at speaker timestamps ===
[Info] Processing 12 unique timestamps

[Timestamp 1/12] t=0.99s (speaker: SPEAKER_00)
[TalkNet] Running: python3 demoTalkNet.py --videoName ingest_52585564 --confidenceThreshold -0.5
2026-01-21 13:41:14 Extract the video and save in demo/ingest_52585564/pyavi/video.avi 
2026-01-21 13:41:14 Extract the audio and save in demo/ingest_52585564/pyavi/audio.wav 
2026-01-21 13:41:14 Extract the frames and save in demo/ingest_52585564/pyframes 
VideoManager is deprecated and will be removed.
`base_timecode` argument is deprecated and has no effect.
demo/ingest_52585564/pyavi/video.avi - scenes detected 4
2026-01-21 13:41:14 Scene detection and save in demo/ingest_52585564/pywork 
2026-01-21 13:41:24 Face detection and save in demo/ingest_52585564/pywork 
2026-01-21 13:41:24 Face track and detected 7 tracks 
100%|████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  6.47it/s]
2026-01-21 13:41:25 Face Crop and saved in demo/ingest_52585564/pycrop tracks 
01-21 13:41:25 Model para number = 15.01
Model pretrain_TalkSet.model loaded from previous state! 
100%|████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:28<00:00,  4.08s/it]
2026-01-21 13:41:53 Scores extracted and saved in demo/ingest_52585564/pywork 
100%|██████████████████████████████████████████████████████████████████████████████████| 753/753 [00:00<00:00, 1041.73it/s]
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t000985

[Timestamp 2/12] t=2.02s (speaker: SPEAKER_00)
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t002025

[Timestamp 3/12] t=3.70s (speaker: SPEAKER_00)
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t003704

[Timestamp 4/12] t=5.29s (speaker: SPEAKER_00)
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t005285

[Timestamp 5/12] t=6.84s (speaker: SPEAKER_01)
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t006845

[Timestamp 6/12] t=9.29s (speaker: SPEAKER_00)
[Detection] Found 0 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 0 boxes (filtered 0)
  [OK] Found 0 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t009285

[Timestamp 7/12] t=17.27s (speaker: SPEAKER_01)
[Detection] Found 0 green boxes, 2 red boxes (before NMS)
[Detection] After NMS: 2 boxes (filtered 0)
  [OK] Found 2 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t017265

[Timestamp 8/12] t=19.91s (speaker: SPEAKER_01)
[Detection] Found 1 green boxes, 1 red boxes (before NMS)
[Detection] After NMS: 2 boxes (filtered 0)
  [OK] Found 2 face boxes, speaker_box=found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t019905

[Timestamp 9/12] t=21.37s (speaker: SPEAKER_00)
[Detection] Found 1 green boxes, 1 red boxes (before NMS)
[Detection] After NMS: 2 boxes (filtered 0)
  [OK] Found 2 face boxes, speaker_box=found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t021365

[Timestamp 10/12] t=22.48s (speaker: SPEAKER_01)
[Detection] Found 1 green boxes, 0 red boxes (before NMS)
[Detection] After NMS: 1 boxes (filtered 0)
  [OK] Found 1 face boxes, speaker_box=found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t022485

[Timestamp 11/12] t=23.93s (speaker: SPEAKER_01)
[Detection] Found 0 green boxes, 1 red boxes (before NMS)
[Detection] After NMS: 1 boxes (filtered 0)
  [OK] Found 1 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t023925

[Timestamp 12/12] t=26.85s (speaker: SPEAKER_01)
[Detection] Found 0 green boxes, 1 red boxes (before NMS)
[Detection] After NMS: 1 boxes (filtered 0)
  [OK] Found 1 face boxes, speaker_box=not found
  [OK] Saved outputs to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/faces/t026845

=== Step 4: Matching 12 faces against database ===
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1769031715.211417  207322 pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
I0000 00:00:1769031715.211519  207322 pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -> physical PluggableDevice (device: 0, name: METAL, pci bus id: <undefined>)
[Match] t17265_face_00_red -> person_2 (distance=0.036580324173937084)
[Match] t17265_face_01_red -> person_1 (distance=0.2808747458986527)
[Match] t19905_face_00_red -> person_2 (distance=0.02642792463399979)
[Match] t19905_face_01_green -> person_1 (distance=0.26769548654629516)
[Match] t19905_speaker -> person_1 (distance=0.26769548654629516)
[Match] t21365_face_00_red -> person_2 (distance=0.024752020836851796)
[Match] t21365_face_01_green -> person_1 (distance=0.46200621128136077)
[Match] t21365_speaker -> person_1 (distance=0.46200621128136077)
[Match] t22485_face_00_green -> person_2 (distance=0.4058678150182944)
[Match] t22485_speaker -> person_2 (distance=0.4058678150182944)
[Match] t23925_face_00_red -> person_1 (distance=0.3702240586287121)
[Match] t26845_face_00_red -> person_1 (distance=0.4285290837293618)
[OK] Face matching results saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/face_matching.json

=== Step 5: Combining results ===
[OK] Final results saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564/final_results.json

================================================================================
FINAL RESULTS
================================================================================

Speaker ID      Face ID              Text                                     Time           
--------------------------------------------------------------------------------
SPEAKER_00      UNKNOWN              Marie.                                   1.2-1.6s       
SPEAKER_00      UNKNOWN              This is Ms. Novak.                       2.2-3.2s       
SPEAKER_00      UNKNOWN              She's from Chicago.                      3.9-5.0s       
SPEAKER_00      UNKNOWN              Marie is our receptionist.               5.5-6.8s       
SPEAKER_01      UNKNOWN              It's nice to meet you. It's nice to m... 7.0-9.4s       
SPEAKER_00      UNKNOWN              I'll get your tickets.                   9.5-10.5s      
SPEAKER_01      person_2             You look very familiar to me, Marie.     17.5-19.7s     
SPEAKER_01      person_1             Have we met before?                      20.1-21.1s     
SPEAKER_00      person_1             I don't think so.                        21.6-22.7s     
SPEAKER_01      person_2             No.                                      22.7-23.3s     
SPEAKER_01      person_1             Well, I never forget a face.             24.1-26.1s     
SPEAKER_01      person_1             I'm sure I know you from somewhere.      27.0-29.3s     

[OK] Results also saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/results.json
[OK] All intermediate outputs saved to: /Users/jasonyang/Documents/Development/memobot/ingest_pipeline/intermediate_outputs/run_52585564